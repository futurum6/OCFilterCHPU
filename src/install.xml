<?xml version="1.0" encoding="utf-8"?>
<modification>
    <name>OCFilterCHPU</name>
    <code>ocfilter_chpu</code>
    <version>1.0.0</version>
    <author>futurum6</author>
    <link>https://github.com/futurum6</link>
 
    <!-- Add rewrite handler in startup/seo_url.php -->
    <file path="catalog/controller/startup/seo_url.php">
        <operation>
            <search><![CDATA[public function index() {]]></search>
            <add position="after"><![CDATA[ 
        // OCFilter CHPU rewrite handler
        if ($this->config->get('module_ocfilter_chpu')) {
            try {
                require_once(DIR_SYSTEM . 'library/ocfilter_chpu.php');
                $ocfilter_chpu = new OCFilterCHPU($this->registry);
                if ($ocfilter_chpu && method_exists($ocfilter_chpu, 'processIncomingUrl')) {
                    $ocfilter_chpu->processIncomingUrl();
                }
                // Add URL rewrite for OCFilter links
                $this->url->addRewrite($ocfilter_chpu);
            } catch (Exception $e) {
                error_log('OCFilterCHPU error: ' . $e->getMessage());
            }
        }]]></add>
        </operation>
    </file>
</modification>